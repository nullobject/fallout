#!/usr/bin/env ruby

$:.unshift File.join(File.expand_path(File.dirname(__FILE__)), '..', 'lib')

require 'rubygems'
require 'bundler/setup'

require 'bucaneer'
require 'fallout'

options = {
  :dev   => '/dev/tty.usbserial-A7004HZe',
  :mode  => :spi,
  :power => true
}

Bucaneer::BusPirate.connect(options) do |spi|
  marquee = Fallout::Marquee.new(spi)

  # If a message finishes then kick-off a new one.
  marquee.when_finished do |marquee|
    marquee.color = [rand, rand, rand]
    marquee.start_message(Time.now.strftime("%H:%M:%S"))
  end

  marquee.start
  sleep 800
  marquee.stop
end
